<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.7" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.23" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://golangguide.top/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html"><meta property="og:site_name" content="golang全栈指南"><meta property="og:title" content="Elasticsearch面试题"><meta property="og:description" content="Elasticsearch面试题 文档查询步骤顺序 先看下整体的查询流程 单个文档 以下是从主分片或者副本分片检索文档的步骤顺序： imgimg 客户端向 Node 1 发送获取请求。 节点使用文档的 _id 来确定文档属于分片 0 。分片 0 的副本分片存在于所有的三个节点上。 在这种情况下，它将请求转发到 Node 2 。 Node 2 将文档返回..."><meta property="og:type" content="article"><meta property="og:image" content="https://cdn.xiaobaidebug.top/es-th-2-21.png"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-03-03T01:50:40.000Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:alt" content="Elasticsearch面试题"><meta property="article:author" content="小白debug"><meta property="article:modified_time" content="2024-03-03T01:50:40.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Elasticsearch面试题","image":["https://cdn.xiaobaidebug.top/es-th-2-21.png","https://cdn.xiaobaidebug.top/es-th-2-22.png","https://pic4.zhimg.com/80/v2-43542fcc0daf345b92c5a674c4197e8b_1440w.webp","https://pic3.zhimg.com/80/v2-8dfcfedc2840b6a405195899437ebeaa_1440w.webp","https://pic3.zhimg.com/80/v2-8b8eccec501800436783e3bfe2c8ad86_1440w.webp","https://pic3.zhimg.com/80/v2-d4c024788023660e7a19c8981b5ce2fa_1440w.webp","https://pic2.zhimg.com/80/v2-98fc4f1cd2b3c13e56dead5850e9db95_1440w.webp","https://cdn.xiaobaidebug.top/v2-aac5b983cb1aa9ec2c81e6624292e469_1440w.webp","https://cdn.xiaobaidebug.top/v2-6ea22f379bab8d83f9e4697f19e75191_1440w.webp","https://cdn.xiaobaidebug.top/v2-aa1a57bbbcbbf04ef089d6681d662ffe_1440w.webp","https://cdn.xiaobaidebug.top/v2-df4c8cd2e2b1dad444a50bab3f6d9bb2_1440w.webp","https://cdn.xiaobaidebug.top/v2-1f5084b94e47d417b3cebd615ef04647_1440w.webp","https://cdn.xiaobaidebug.top/v2-d5426155b3c3c0a7e49123954f96e347_1440w.webp"],"dateModified":"2024-03-03T01:50:40.000Z","author":[{"@type":"Person","name":"小白debug","url":"https://xiaobaidebug.top/"}]}</script><link rel="canonical" href="https://golangguide.top/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Elasticsearch面试题","image":[""],"dateModified":"2024-03-03T01:50:40.000Z","author":[]}</script><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap"><meta name="keywords" content="面试, 程序员, golang, golang指南, mysql, redis, elastic search, kafka, rocketmq, 微服务, 分布式, Docker"><meta name="description" content="你需要的关于 golang 全栈后端开发的所有信息，包括但不限于mysql, redis, elasticsearch，微服务，kafka, 计算机网络，操作系统等信息"><meta name="author" content="https://www.xiaobaidebug.top/"><meta name="og:image" content="https://golangguide.top/new_logo.png"><meta property="og:image" content="https://golangguide.top/new_logo.png"><meta name="og:image:secure_url" content="https://golangguide.top/new_logo.png"><meta name="og:url" content="https://golangguide.top/"><meta property="og:title" content="欢迎来到 golangguide - 你需要的关于 golang 全栈后端开发的所有信息，包括但不限于mysql, redis, elasticsearch，微服务，kafka等信息"><meta name="og:description" content="golangguide Docs bring you all information you need about our protocol, APIs, SDKs, ZK Stack, and hyperchains. Start with our guides and tutorials, or go deep into our architecture and protocol specification."><meta name="twitter:title" content="Welcome to our Docs - All information you need about golangguide and ZK Stack"><meta name="twitter:description" content="golangguide Docs bring you all information you need about our protocol, APIs, SDKs, ZK Stack, and hyperchains. Start with our guides and tutorials, or go deep into our architecture and protocol specification."><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="manifest" href="/site.webmanifest"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#1E69FF"><link rel="shortcut icon" href="/favicon.ico"><meta name="msapplication-TileColor" content="#1E69FF"><meta name="msapplication-config" content="/browserconfig.xml"><meta name="theme-color" content="#1755F4"><script>
      window.addEventListener('load', function() {
        let contributors = document.querySelectorAll('.contributor');
        let contributorArr = Array.from(contributors);
        let topFive = contributorArr.slice(0, 5);
      
        topFive.forEach(function(contributor) {
          contributor.textContent = contributor.textContent.replace(',', '');
        });
      
        let lastComma = contributorArr[4];
        lastComma.textContent = lastComma.textContent.replace(',', '');
      
        let updatedList = topFive.map(function(contributor) {
          return contributor.textContent;
        }).join(', ');
          
        let contributorsDiv = document.querySelector('.contributors');
        contributorsDiv.innerHTML = '<span class="label">Contributors: </span>' + updatedList;
      
      });

      </script><title>Elasticsearch面试题 | golang全栈指南</title>
    <link rel="preload" href="/assets/style-pUUM4cAF.css" as="style"><link rel="stylesheet" href="/assets/style-pUUM4cAF.css">
    <link rel="modulepreload" href="/assets/app-D66NMc_a.js"><link rel="modulepreload" href="/assets/面试题.html-Fqk5LBx7.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-D-czDnBM.js" as="script"><link rel="prefetch" href="/assets/学习路线.html-Bgr7XIR4.js" as="script"><link rel="prefetch" href="/assets/常用包大全.html-BCc4Kzq1.js" as="script"><link rel="prefetch" href="/assets/目录.html-DxzF3yXG.js" as="script"><link rel="prefetch" href="/assets/介绍.html-BtKt0Zrg.js" as="script"><link rel="prefetch" href="/assets/入营须知.html-zk7pRQ4z.js" as="script"><link rel="prefetch" href="/assets/for select时，如果通道已经关闭会怎么样？如果只有一个case呢？.html-C--Wlcfd.js" as="script"><link rel="prefetch" href="/assets/golang 面试题：reflect（反射包）如何获取字段 tag？为什么 json 包不能导出私有变量的 tag？.html-DpAStjUc.js" as="script"><link rel="prefetch" href="/assets/golang面试题：json包变量不加tag会怎么样？.html-Cs4TicJE.js" as="script"><link rel="prefetch" href="/assets/golang面试题：字符串转成byte数组，会发生内存拷贝吗？.html-BdQHia3W.js" as="script"><link rel="prefetch" href="/assets/golang面试题：对已经关闭的的chan进行读写，会怎么样？为什么？.html-GFbsU7rG.js" as="script"><link rel="prefetch" href="/assets/golang面试题：对未初始化的的chan进行读写，会怎么样？为什么？.html-wHh94Js6.js" as="script"><link rel="prefetch" href="/assets/golang面试题：怎么避免内存逃逸？.html-BDZ0Bfw6.js" as="script"><link rel="prefetch" href="/assets/golang面试题：拷贝大切片一定比小切片代价大吗？.html-ZHew2ctQ.js" as="script"><link rel="prefetch" href="/assets/golang面试题：简单聊聊内存逃逸？.html-H-6H0dcc.js" as="script"><link rel="prefetch" href="/assets/golang面试题：翻转含有中文、数字、英文字母的字符串.html-BlPeyS4e.js" as="script"><link rel="prefetch" href="/assets/golang高性能无GC的缓存库bigcache是怎么实现的.html-v_d7F5vY.js" as="script"><link rel="prefetch" href="/assets/io_timeout，希望你不要踩到这个http包的坑.html-DHa_iSL5.js" as="script"><link rel="prefetch" href="/assets/动图图解！怎么让goroutine跑一半就退出？.html-GhNAUsMM.js" as="script"><link rel="prefetch" href="/assets/动图图解，GMP里为什么要有P.html-B3HE81Yp.js" as="script"><link rel="prefetch" href="/assets/如何调用一个只支持batch_call的服务？.html-DciOAQMr.js" as="script"><link rel="prefetch" href="/assets/昨天那个在for循环里append元素的同事，今天还在么？.html-DjKwufYk.js" as="script"><link rel="prefetch" href="/assets/给大家丢脸了，用了三年golang，我还是没答对这道内存泄漏题.html-DPBm2tam.js" as="script"><link rel="prefetch" href="/assets/能说说uintptr和unsafe.Pointer的区别吗.html-DoOxLV7G.js" as="script"><link rel="prefetch" href="/assets/连nil切片和空切片一不一样都不清楚？那BAT面试官只好让你回去等通知了。.html-EV0_2umr.js" as="script"><link rel="prefetch" href="/assets/1.Go入门.html-C5_Q3dbX.js" as="script"><link rel="prefetch" href="/assets/2.Go进阶.html-DDd77yuh.js" as="script"><link rel="prefetch" href="/assets/1. Python 的起源与发展.html-Du-5Ckzb.js" as="script"><link rel="prefetch" href="/assets/10. Python 标准库概览.html-BVvILi6B.js" as="script"><link rel="prefetch" href="/assets/11. 字符串操作与正则表达式.html-DXHhALoq.js" as="script"><link rel="prefetch" href="/assets/12. 列表、元组、字典与集合.html--OcpHazk.js" as="script"><link rel="prefetch" href="/assets/13. 时间与日期处理.html-C9GcIBBB.js" as="script"><link rel="prefetch" href="/assets/14. 常用内建函数.html-Ciyo2_Vf.js" as="script"><link rel="prefetch" href="/assets/15. 生成器与迭代器.html-BcWPjSnf.js" as="script"><link rel="prefetch" href="/assets/2. 安装与环境配置.html-BOVX1BMS.js" as="script"><link rel="prefetch" href="/assets/3. 变量、数据类型与运算符.html-BeIzjRoC.js" as="script"><link rel="prefetch" href="/assets/4. 控制流程：条件与循环.html-CjFGQ0qY.js" as="script"><link rel="prefetch" href="/assets/5. 函数与模块.html-pHo4AoyG.js" as="script"><link rel="prefetch" href="/assets/6. 输入与输出.html-B2MP2wk4.js" as="script"><link rel="prefetch" href="/assets/7. 异常处理.html-dOU3qlAK.js" as="script"><link rel="prefetch" href="/assets/8. 面向对象编程基础.html-q-b77P6F.js" as="script"><link rel="prefetch" href="/assets/9. 文件操作与管理.html-znogiu7Y.js" as="script"><link rel="prefetch" href="/assets/16. 线程与多线程编程.html-dThU1pz-.js" as="script"><link rel="prefetch" href="/assets/17. 进程与多进程编程.html-C-xXAzPC.js" as="script"><link rel="prefetch" href="/assets/18. 异步编程与协程.html-Bg1zl8kw.js" as="script"><link rel="prefetch" href="/assets/19. 并发编程中的常见问题与解决方案.html-CH-VS__y.js" as="script"><link rel="prefetch" href="/assets/20. 线程安全与锁机制.html-CEJLYndA.js" as="script"><link rel="prefetch" href="/assets/21. 进程间通信与共享资源.html-C18h41jy.js" as="script"><link rel="prefetch" href="/assets/22. 异步编程框架比较.html-BTlCpquj.js" as="script"><link rel="prefetch" href="/assets/23. GIL 与 Python 多线程.html-COVKwHrv.js" as="script"><link rel="prefetch" href="/assets/24. 多进程与多线程的选择.html-6WAMaVWT.js" as="script"><link rel="prefetch" href="/assets/25. asyncio 库与异步 IO 模型.html-DtcV18pg.js" as="script"><link rel="prefetch" href="/assets/26. 多进程池与线程池.html-Dga4S92O.js" as="script"><link rel="prefetch" href="/assets/27. 并行与并发的区别.html-Xj9F2yrg.js" as="script"><link rel="prefetch" href="/assets/28. 异步编程中的回调地狱问题.html-CKKsbSSk.js" as="script"><link rel="prefetch" href="/assets/29. 高并发与高性能的设计原则.html-D0i4i4UH.js" as="script"><link rel="prefetch" href="/assets/30. 分布式计算与任务调度.html-BDLIEA8M.js" as="script"><link rel="prefetch" href="/assets/31. 迭代器与生成器.html-DQpjKLKr.js" as="script"><link rel="prefetch" href="/assets/32. 装饰器与闭包.html-DdF2-EMq.js" as="script"><link rel="prefetch" href="/assets/33. 元类与类装饰器.html-Y8hwGT5b.js" as="script"><link rel="prefetch" href="/assets/34. 设计模式与最佳实践.html-PevcyM8A.js" as="script"><link rel="prefetch" href="/assets/35. 函数式编程风格.html-DHTUg8bw.js" as="script"><link rel="prefetch" href="/assets/36. Python 代码优化与性能提升.html-za6hJuqd.js" as="script"><link rel="prefetch" href="/assets/37. 高级函数与 Lambda 表达式.html-C2B1YB7B.js" as="script"><link rel="prefetch" href="/assets/38. 魔术方法与元编程.html-BKBdJAIb.js" as="script"><link rel="prefetch" href="/assets/39. 动态类型与静态类型语言对比.html-BDV2Xt_1.js" as="script"><link rel="prefetch" href="/assets/40. 高级模块与扩展.html-CZQUD3Y6.js" as="script"><link rel="prefetch" href="/assets/41. 编码规范与文档.html-CSUn9pih.js" as="script"><link rel="prefetch" href="/assets/42. 版本控制与 Git.html-BqC3u2b7.js" as="script"><link rel="prefetch" href="/assets/43. 虚拟环境与依赖管理.html-nJs01sTi.js" as="script"><link rel="prefetch" href="/assets/44. IDE 与编辑器推荐.html-CPs9KXgD.js" as="script"><link rel="prefetch" href="/assets/45. 调试工具与技巧.html-CSCEJWGp.js" as="script"><link rel="prefetch" href="/assets/46. 单元测试与集成测试.html-9RWZ7LE9.js" as="script"><link rel="prefetch" href="/assets/47. 静态代码分析与 Lint 工具.html-C2NjSeOG.js" as="script"><link rel="prefetch" href="/assets/48. 代码重构与优化工具.html-CV3JKRrJ.js" as="script"><link rel="prefetch" href="/assets/49. CI-CD 与持续集成.html-Okzvq_82.js" as="script"><link rel="prefetch" href="/assets/50. 文档生成与自动化部署.html-BK1Nmn06.js" as="script"><link rel="prefetch" href="/assets/51. 常见算法概述.html-DqWS-RqG.js" as="script"><link rel="prefetch" href="/assets/52. 排序与搜索算法.html-D30LRIzA.js" as="script"><link rel="prefetch" href="/assets/53. 数据结构与算法设计.html-C2Hy-j3F.js" as="script"><link rel="prefetch" href="/assets/54. 动态规划与贪心算法.html-BxM5ruP4.js" as="script"><link rel="prefetch" href="/assets/55. 图论与网络流算法.html-B6QeJWI5.js" as="script"><link rel="prefetch" href="/assets/56. 字符串匹配与处理算法.html-DpafVub0.js" as="script"><link rel="prefetch" href="/assets/57. 数论与组合数学.html-BXwbWiWC.js" as="script"><link rel="prefetch" href="/assets/58. 复杂度分析与算法评估.html-U7KQ3nXG.js" as="script"><link rel="prefetch" href="/assets/59. 算法实现与优化技巧.html-0Ghpr1yv.js" as="script"><link rel="prefetch" href="/assets/60. 常用数据结构实现.html-x6L_rCQT.js" as="script"><link rel="prefetch" href="/assets/61. 数据获取与清洗.html-Cpxo1MnZ.js" as="script"><link rel="prefetch" href="/assets/62. 数据处理与分析.html-CPSCPRgc.js" as="script"><link rel="prefetch" href="/assets/63. 数据可视化.html-W-zdsrYv.js" as="script"><link rel="prefetch" href="/assets/64. 机器学习入门.html-COt6zshZ.js" as="script"><link rel="prefetch" href="/assets/65. 数据挖掘与预测建模.html-BFv8e-M7.js" as="script"><link rel="prefetch" href="/assets/66. 数据库与数据仓库.html-BrVMHSrb.js" as="script"><link rel="prefetch" href="/assets/67. 大数据与分布式计算.html-BDlx6e04.js" as="script"><link rel="prefetch" href="/assets/68. 自然语言处理基础.html-B3D0fBX6.js" as="script"><link rel="prefetch" href="/assets/69. 图像处理与计算机视觉.html-ClMke1Rh.js" as="script"><link rel="prefetch" href="/assets/70. 时间序列分析与预测.html-Bvevolg5.js" as="script"><link rel="prefetch" href="/assets/71. Linux 基础与常用命令.html-CIoyw3OW.js" as="script"><link rel="prefetch" href="/assets/72. 网络基础与常用协议.html-B2-a5aoX.js" as="script"><link rel="prefetch" href="/assets/73. Web 服务器与部署.html-Dc952HpE.js" as="script"><link rel="prefetch" href="/assets/74. 数据库基础与管理.html-B92SLSBy.js" as="script"><link rel="prefetch" href="/assets/75. 容器化与 Docker.html-CjsRt-PB.js" as="script"><link rel="prefetch" href="/assets/76. 自动化运维与配置管理.html-DM_1Pu7O.js" as="script"><link rel="prefetch" href="/assets/77. 负载均衡与高可用性.html-BnPcNJDC.js" as="script"><link rel="prefetch" href="/assets/78. 日志与监控系统.html-B9MgvHKw.js" as="script"><link rel="prefetch" href="/assets/79. 安全与漏洞管理.html-CbxQLNxW.js" as="script"><link rel="prefetch" href="/assets/80. 云计算与云服务.html-DNx3fS9r.js" as="script"><link rel="prefetch" href="/assets/81. NumPy 与 SciPy.html-D2HLG21M.js" as="script"><link rel="prefetch" href="/assets/82. Pandas.html-Bqzg3T0e.js" as="script"><link rel="prefetch" href="/assets/83. Matplotlib 与 Seaborn.html-B_fmmgX4.js" as="script"><link rel="prefetch" href="/assets/84. Requests 与 Beautiful Soup.html-DFveNGPv.js" as="script"><link rel="prefetch" href="/assets/85. Django 与 Flask.html-BQV8nWjJ.js" as="script"><link rel="prefetch" href="/assets/86. SQLAlchemy 与 ORM.html-B8sCY3Uk.js" as="script"><link rel="prefetch" href="/assets/87. Celery 与任务队列.html-C7Wm7Xxx.js" as="script"><link rel="prefetch" href="/assets/88. TensorFlow 与机器学习库.html-Dk_v2vf6.js" as="script"><link rel="prefetch" href="/assets/89. PyQT 与 GUI 开发.html-ojKUDWTj.js" as="script"><link rel="prefetch" href="/assets/90. GIS 与地理信息处理.html-kLgsmZPC.js" as="script"><link rel="prefetch" href="/assets/100.  项目总结与回顾.html-BVp26Ha1.js" as="script"><link rel="prefetch" href="/assets/91. 项目介绍与需求分析.html-a33s5aY8.js" as="script"><link rel="prefetch" href="/assets/92. 项目架构与设计.html-BXdazDg5.js" as="script"><link rel="prefetch" href="/assets/93. 代码实现与测试.html-DVNNSzI-.js" as="script"><link rel="prefetch" href="/assets/94. 项目部署与维护.html-Btw9oUtw.js" as="script"><link rel="prefetch" href="/assets/95. 用户反馈与迭代优化.html-CQGbGKi0.js" as="script"><link rel="prefetch" href="/assets/96. 项目文档与知识分享.html-URQluakd.js" as="script"><link rel="prefetch" href="/assets/97. 团队协作与版本控制.html-nVPpRtbx.js" as="script"><link rel="prefetch" href="/assets/98. 项目上线与发布.html-ClUPdtiX.js" as="script"><link rel="prefetch" href="/assets/99. 故障处理与紧急修复.html-BfdSkh4S.js" as="script"><link rel="prefetch" href="/assets/面试题.html-DJYZt2d8.js" as="script"><link rel="prefetch" href="/assets/面试题.html-8H3jGkSs.js" as="script"><link rel="prefetch" href="/assets/面试题.html-BZd5jNuO.js" as="script"><link rel="prefetch" href="/assets/面试题.html-Xjxh1HKj.js" as="script"><link rel="prefetch" href="/assets/面试题.html-Dp0SKyXn.js" as="script"><link rel="prefetch" href="/assets/面试题.html-L-P15eAn.js" as="script"><link rel="prefetch" href="/assets/面试题.html-DPAegLJg.js" as="script"><link rel="prefetch" href="/assets/面试题.html-CyjNCYMB.js" as="script"><link rel="prefetch" href="/assets/面试题.html-BDOe3JDd.js" as="script"><link rel="prefetch" href="/assets/面试题.html-Dlo8o2C0.js" as="script"><link rel="prefetch" href="/assets/面试题.html-Crty8src.js" as="script"><link rel="prefetch" href="/assets/面试题.html-D-t6EA1i.js" as="script"><link rel="prefetch" href="/assets/面试题.html-DMUEzGCE.js" as="script"><link rel="prefetch" href="/assets/面试题.html-BkwNtSfe.js" as="script"><link rel="prefetch" href="/assets/Mysql并发写数据，怎么保证唯一性？.html-C5WqsWs6.js" as="script"><link rel="prefetch" href="/assets/Mysql数据库查询好慢，除了索引，还能因为什么？.html-DhBNh1MY.js" as="script"><link rel="prefetch" href="/assets/Mysql的索引为什么使用B_树而不使用跳表？.html-T9LoclJ6.js" as="script"><link rel="prefetch" href="/assets/mysql主库更新后，从库读到最新值了，主库还有可能读到旧值吗？.html-YfvahMd7.js" as="script"><link rel="prefetch" href="/assets/mysql查询 limit 1000_10 和limit 10 速度一样快吗？.html-gosB6UM0.js" as="script"><link rel="prefetch" href="/assets/mysql的varchar字段最大长度真的是65535吗？.html-CeqD-Hmb.js" as="script"><link rel="prefetch" href="/assets/为什么mysql写数据会丢失数据？.html-BfGVXYnh.js" as="script"><link rel="prefetch" href="/assets/为什么mysql插入不存在的数据会产生死锁？.html-D1MVkUnv.js" as="script"><link rel="prefetch" href="/assets/为什么mysql的count()方法这么慢？.html-Cp0D5AHZ.js" as="script"><link rel="prefetch" href="/assets/为什么大家说mysql数据库单表最大两千万？.html-YOY20zGs.js" as="script"><link rel="prefetch" href="/assets/分库分表带来的读扩散问题，怎么解决？.html-z2-i-bCC.js" as="script"><link rel="prefetch" href="/assets/数据库主键一定要自增的吗？不自增行不行？有哪些场景下不建议自增？.html-CV7Lib94.js" as="script"><link rel="prefetch" href="/assets/都是select语句，为什么读到的内容不一样？.html-7H3WUpRt.js" as="script"><link rel="prefetch" href="/assets/QPS的计算是怎么实现的.html-CqQBXU8b.js" as="script"><link rel="prefetch" href="/assets/服务发现有哪些要素.html-BechFCoY.js" as="script"><link rel="prefetch" href="/assets/给32位系统装8g内存条能用吗？为什么？.html-DN2JkLEf.js" as="script"><link rel="prefetch" href="/assets/TCP四次挥手中如果服务端没收到第四次挥手请求，服务端会一直等待吗？.html-Bg0xvLfl.js" as="script"><link rel="prefetch" href="/assets/TCP粘包！数据包：我只是犯了每个数据包都会犯的错，硬核图解.html-BOZ9cBdR.js" as="script"><link rel="prefetch" href="/assets/UDP就一定比TCP快吗.html-CFacF07t.js" as="script"><link rel="prefetch" href="/assets/socket到底是什么？.html-Cec3VGK-.js" as="script"><link rel="prefetch" href="/assets/不是我不回你消息，是因为网络会丢包.html-DJyXT_6z.js" as="script"><link rel="prefetch" href="/assets/为什么我们的IP都是192.168开头的？.html-BzSBS6Cp.js" as="script"><link rel="prefetch" href="/assets/为什么我在公司里访问不了家里的电脑？.html-CTZRUZlh.js" as="script"><link rel="prefetch" href="/assets/为什么有HTTP协议，还要有websocket协议.html-C-2Jacbc.js" as="script"><link rel="prefetch" href="/assets/动图图解！代码执行send成功后，数据就发出去了吗？.html-C7s4-2mD.js" as="script"><link rel="prefetch" href="/assets/动图图解！收到RST，就一定会断开TCP连接吗？.html-BIX-VB54.js" as="script"><link rel="prefetch" href="/assets/动图图解！既然IP层会分片，为什么TCP层也还要分段？.html-CxOMSlzo.js" as="script"><link rel="prefetch" href="/assets/既然有HTTP协议，为什么还要有RPC协议？.html-C4MwxJvk.js" as="script"><link rel="prefetch" href="/assets/没有accept能建立TCP连接吗.html-Dma8gyNf.js" as="script"><link rel="prefetch" href="/assets/活久见！TCP两次挥手，你见过吗？那四次握手呢？.html-D2wx45uu.js" as="script"><link rel="prefetch" href="/assets/硬核图解！30张图带你搞懂！路由器，集线器，交换机，网桥，光猫有啥区别？.html-CwHT1JHw.js" as="script"><link rel="prefetch" href="/assets/硬核图解！断网了，还能ping通回环地址吗？为什么.html-ChEteLrS.js" as="script"><link rel="prefetch" href="/assets/硬核！漫画图解HTTP知识点_面试题.html-BkSe-T53.js" as="script"><link rel="prefetch" href="/assets/能ping通，就代表TCP一定能连通吗？.html-6QYUEEGF.js" as="script"><link rel="prefetch" href="/assets/连接一个IP不存在的主机时，握手过程是怎样的.html-Dcd1oRNv.js" as="script"><link rel="prefetch" href="/assets/404.html-g6ozzlVZ.js" as="script"><link rel="prefetch" href="/assets/index.html-C25BXf9D.js" as="script"><link rel="prefetch" href="/assets/index.html-BrUhHFke.js" as="script"><link rel="prefetch" href="/assets/index.html-gGSJGP2o.js" as="script"><link rel="prefetch" href="/assets/index.html-j4QYANM_.js" as="script"><link rel="prefetch" href="/assets/index.html-Bf1rsQ5v.js" as="script"><link rel="prefetch" href="/assets/index.html-JjmYnjwX.js" as="script"><link rel="prefetch" href="/assets/index.html-hcXChOZk.js" as="script"><link rel="prefetch" href="/assets/index.html-CsT0tQ0C.js" as="script"><link rel="prefetch" href="/assets/index.html-CGAdKUqd.js" as="script"><link rel="prefetch" href="/assets/index.html-C1DMLROs.js" as="script"><link rel="prefetch" href="/assets/index.html-CSdf-Jg1.js" as="script"><link rel="prefetch" href="/assets/index.html-DooaZQgG.js" as="script"><link rel="prefetch" href="/assets/index.html-1PnydT5H.js" as="script"><link rel="prefetch" href="/assets/index.html-C_M954gB.js" as="script"><link rel="prefetch" href="/assets/index.html-BTlYfbfy.js" as="script"><link rel="prefetch" href="/assets/index.html-CZ5Mvov0.js" as="script"><link rel="prefetch" href="/assets/index.html-Fmp7z8Ek.js" as="script"><link rel="prefetch" href="/assets/index.html-BZq6WqXO.js" as="script"><link rel="prefetch" href="/assets/index.html-Dr-hE6zS.js" as="script"><link rel="prefetch" href="/assets/index.html-CaRKvePV.js" as="script"><link rel="prefetch" href="/assets/index.html-C7NO3Bhp.js" as="script"><link rel="prefetch" href="/assets/index.html-5-qmAwOT.js" as="script"><link rel="prefetch" href="/assets/index.html-CQUzsQMI.js" as="script"><link rel="prefetch" href="/assets/index.html-K9k_ZYWT.js" as="script"><link rel="prefetch" href="/assets/index.html-yKvFh3lF.js" as="script"><link rel="prefetch" href="/assets/index.html-Dflcfyu5.js" as="script"><link rel="prefetch" href="/assets/index.html-SArSj-pO.js" as="script"><link rel="prefetch" href="/assets/index.html-Ds2l8-E_.js" as="script"><link rel="prefetch" href="/assets/index.html-CIKxdCk5.js" as="script"><link rel="prefetch" href="/assets/index.html-3gkjigQ2.js" as="script"><link rel="prefetch" href="/assets/index.html-CTCgO3Zi.js" as="script"><link rel="prefetch" href="/assets/index.html-YDK3aUsV.js" as="script"><link rel="prefetch" href="/assets/index.html-wBizC8I2.js" as="script"><link rel="prefetch" href="/assets/index.html-mb7heoUy.js" as="script"><link rel="prefetch" href="/assets/index.html-C6cc-2DZ.js" as="script"><link rel="prefetch" href="/assets/index.html-22tOWLQ0.js" as="script"><link rel="prefetch" href="/assets/index.html-BpdvpBk2.js" as="script"><link rel="prefetch" href="/assets/index.html-cXWofjSP.js" as="script"><link rel="prefetch" href="/assets/giscus-7BMGhbDA.js" as="script"><link rel="prefetch" href="/assets/auto-C0MMSKEI.js" as="script"><link rel="prefetch" href="/assets/index-DA4axBLK.js" as="script"><link rel="prefetch" href="/assets/flowchart-966sEcGG.js" as="script"><link rel="prefetch" href="/assets/mermaid.core-CdoTo4y5.js" as="script"><link rel="prefetch" href="/assets/reveal.esm-9nNZbZvi.js" as="script"><link rel="prefetch" href="/assets/markdown.esm-BG2Xu2Hd.js" as="script"><link rel="prefetch" href="/assets/vue-repl-BOjYzicK.js" as="script"><link rel="prefetch" href="/assets/codemirror-editor-iwpM3z72.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-SzV8tJDW.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="/new_logo.png" alt><!----><span class="vp-site-name hide-in-pad">golang全栈指南</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a class="route-link nav-link" href="/" aria-label="主页"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>主页<!----></a></div><div class="nav-item hide-in-mobile"><a class="route-link nav-link" href="/python/" aria-label="Python"><!---->Python<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="训练营"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-campground" style=""></span>训练营</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="route-link nav-link" href="/%E8%AE%AD%E7%BB%83%E8%90%A5/%E4%BB%8B%E7%BB%8D.html" aria-label="介绍"><span class="font-icon icon fa-fw fa-sm fas fa-address-card" style=""></span>介绍<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/%E8%AE%AD%E7%BB%83%E8%90%A5/%E5%85%A5%E8%90%A5%E9%A1%BB%E7%9F%A5.html" aria-label="入营须知"><span class="font-icon icon fa-fw fa-sm fas fa-brain" style=""></span>入营须知<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="计算机基础"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-computer" style=""></span>计算机基础</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="route-link nav-link" href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" aria-label="操作系统"><span class="font-icon icon fa-fw fa-sm fas fa-server" style=""></span>操作系统<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/" aria-label="网络基础"><span class="font-icon icon fa-fw fa-sm fas fa-wifi" style=""></span>网络基础<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="架构"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-folder-tree" style=""></span>架构</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="route-link nav-link" href="/%E6%9E%B6%E6%9E%84/Docker/" aria-label="Docker"><span class="font-icon icon fa-fw fa-sm fas fa-box" style=""></span>Docker<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/%E6%9E%B6%E6%9E%84/%E5%88%86%E5%B8%83%E5%BC%8F/" aria-label="分布式"><span class="font-icon icon fa-fw fa-sm fas fa-manat-sign" style=""></span>分布式<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/%E6%9E%B6%E6%9E%84/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" aria-label="微服务"><span class="font-icon icon fa-fw fa-sm fas fa-microchip" style=""></span>微服务<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/%E6%9E%B6%E6%9E%84/%E8%BF%90%E7%BB%B4/" aria-label="运维"><span class="font-icon icon fa-fw fa-sm fas fa-folder-open" style=""></span>运维<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="中间件"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-align-center" style=""></span>中间件</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="route-link nav-link active" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/" aria-label="ES"><span class="font-icon icon fa-fw fa-sm fas fa-magnifying-glass" style=""></span>ES<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/kafka/" aria-label="Kafka"><span class="font-icon icon fa-fw fa-sm fas fa-chess-queen" style=""></span>Kafka<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/Memcached/" aria-label="Memcached"><span class="font-icon icon fa-fw fa-sm fas fa-suitcase" style=""></span>Memcached<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/ClickHouse/" aria-label="ClickHouse"><span class="font-icon icon fa-fw fa-sm fas fa-house-laptop" style=""></span>ClickHouse<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/mongodb/" aria-label="Mongodb"><span class="font-icon icon fa-fw fa-sm fas fa-vr-cardboard" style=""></span>Mongodb<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/mysql/" aria-label="Mysql"><span class="font-icon icon fa-fw fa-sm fas fa-database" style=""></span>Mysql<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/nginx/" aria-label="Nginx"><span class="font-icon icon fa-fw fa-sm fas fa-network-wired" style=""></span>Nginx<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/rabbitmq/" aria-label="RabbitMQ"><span class="font-icon icon fa-fw fa-sm fas fa-frog" style=""></span>RabbitMQ<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/" aria-label="Redis"><span class="font-icon icon fa-fw fa-sm fas fa-registered" style=""></span>Redis<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/rocketmq/" aria-label="RocketMQ"><span class="font-icon icon fa-fw fa-sm fas fa-rocket" style=""></span>RocketMQ<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="Golang"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-lightbulb" style=""></span>Golang</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="route-link nav-link" href="/golang/%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF.html" aria-label="学习路线"><span class="font-icon icon fa-fw fa-sm fas fa-map-location-dot" style=""></span>学习路线<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/golang/%E5%B8%B8%E7%94%A8%E5%8C%85%E5%A4%A7%E5%85%A8.html" aria-label="常用包大全"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>常用包大全<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/golang/%E9%9D%A2%E8%AF%95%E9%A2%98/1.Go%E5%85%A5%E9%97%A8.html" aria-label="基础面试题"><span class="font-icon icon fa-fw fa-sm fas fa-disease" style=""></span>基础面试题<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/golang/%E9%9D%A2%E8%AF%95%E9%A2%98/2.Go%E8%BF%9B%E9%98%B6.html" aria-label="进阶面试题"><span class="font-icon icon fa-fw fa-sm fas fa-clipboard-question" style=""></span>进阶面试题<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="https://xiaobaidebug.top/" rel="noopener noreferrer" target="_blank" aria-label="blog" class="nav-link"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>blog<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="nav-item hide-in-mobile"><a href="https://golangguide.top/sitemap.xml" rel="noopener noreferrer" target="_blank" aria-label="sitemap" class="nav-link"><span class="font-icon icon fa-fw fa-sm fas fa-blog" style=""></span>sitemap<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/xiaobaiTech/golang-full-stack" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading clickable active"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><a class="route-link nav-link vp-sidebar-title" href="/中间件/中间件/" aria-label="中间件"><!---->中间件<!----></a><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Click House</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable active" type="button"><!----><span class="vp-sidebar-title">Es</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><!--[--><a class="route-link nav-link active vp-sidebar-link vp-sidebar-page active" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html" aria-label="Elasticsearch面试题"><!---->Elasticsearch面试题<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#文档查询步骤顺序" aria-label="文档查询步骤顺序"><!---->文档查询步骤顺序<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#单个文档" aria-label="单个文档"><!---->单个文档<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#多个文档" aria-label="多个文档"><!---->多个文档<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#您能解释一下-x-pack-for-elasticsearch-的功能和重要性吗" aria-label="您能解释一下 X-Pack for Elasticsearch 的功能和重要性吗？"><!---->您能解释一下 X-Pack for Elasticsearch 的功能和重要性吗？<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#elasticsearch-中的节点-比如共-20-个-其中的-10-个选了-一个-master-另外-10-个选了另一个-master-怎么办" aria-label="Elasticsearch  中的节点（比如共  20  个），其中的  10  个选了 一个 master，另外  10  个选了另一个  master，怎么办？"><!---->Elasticsearch  中的节点（比如共  20  个），其中的  10  个选了 一个 master，另外  10  个选了另一个  master，怎么办？<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#解释一下-elasticsearch-集群中的-索引的概念" aria-label="解释一下  Elasticsearch 集群中的  索引的概念  ？"><!---->解释一下  Elasticsearch 集群中的  索引的概念  ？<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#你可以列出-elasticsearch-各种类型的分析器吗" aria-label="你可以列出  Elasticsearch  各种类型的分析器吗？"><!---->你可以列出  Elasticsearch  各种类型的分析器吗？<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#解释一下-elasticsearch-node" aria-label="解释一下  Elasticsearch Node？"><!---->解释一下  Elasticsearch Node？<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#在安装-elasticsearch-时-请说明不同的软件包及其重要性" aria-label="在安装 Elasticsearch 时，请说明不同的软件包及其重要性？"><!---->在安装 Elasticsearch 时，请说明不同的软件包及其重要性？<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#elasticsearch-在部署时-对-linux-的设置有哪些优化方法" aria-label="Elasticsearch 在部署时，对 Linux 的设置有哪些优化方法？"><!---->Elasticsearch 在部署时，对 Linux 的设置有哪些优化方法？<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#请解释有关-elasticsearch-的-nrt" aria-label="请解释有关  Elasticsearch 的  NRT？"><!---->请解释有关  Elasticsearch 的  NRT？<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#elasticsearch-的-document-设计" aria-label="elasticsearch  的  document 设计"><!---->elasticsearch  的  document 设计<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#elasticsearch-了解多少-说说你们公司-es-的集群架构-索引数据大小-分片有多少-以及一些调优手段-。" aria-label="elasticsearch 了解多少，说说你们公司 es 的集群架构，索引数据大小，分片有多少，以及一些调优手段 。"><!---->elasticsearch 了解多少，说说你们公司 es 的集群架构，索引数据大小，分片有多少，以及一些调优手段 。<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#elasticsearch-的倒排索引是什么" aria-label="elasticsearch 的倒排索引是什么"><!---->elasticsearch 的倒排索引是什么<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#elasticsearch-索引数据多了怎么办-如何调优-部署" aria-label="elasticsearch 索引数据多了怎么办，如何调优，部署"><!---->elasticsearch 索引数据多了怎么办，如何调优，部署<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#elasticsearch-是如何实现-master-选举的" aria-label="elasticsearch 是如何实现 master 选举的"><!---->elasticsearch 是如何实现 master 选举的<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#详细描述一下-elasticsearch-索引文档的过程" aria-label="详细描述一下 Elasticsearch 索引文档的过程"><!---->详细描述一下 Elasticsearch 索引文档的过程<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#详细描述一下-elasticsearch-搜索的过程" aria-label="详细描述一下 Elasticsearch 搜索的过程？"><!---->详细描述一下 Elasticsearch 搜索的过程？<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#elasticsearch-在部署时-对-linux-的设置有哪些优化方法-1" aria-label="Elasticsearch 在部署时，对 Linux 的设置有哪些优化方法"><!---->Elasticsearch 在部署时，对 Linux 的设置有哪些优化方法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#lucence-内部结构是什么" aria-label="lucence 内部结构是什么？"><!---->lucence 内部结构是什么？<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#elasticsearch-是如何实现-master-选举的-1" aria-label="Elasticsearch 是如何实现 Master 选举的？"><!---->Elasticsearch 是如何实现 Master 选举的？<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#elasticsearch-中的节点-比如共-20-个-其中的-10-个" aria-label="Elasticsearch 中的节点（比如共 20 个），其中的 10 个"><!---->Elasticsearch 中的节点（比如共 20 个），其中的 10 个<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#客户端在和集群连接时-如何选择特定的节点执行请求的" aria-label="客户端在和集群连接时，如何选择特定的节点执行请求的？"><!---->客户端在和集群连接时，如何选择特定的节点执行请求的？<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#详细描述一下-elasticsearch-索引文档的过程。" aria-label="详细描述一下 Elasticsearch 索引文档的过程。"><!---->详细描述一下 Elasticsearch 索引文档的过程。<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#详细描述一下-elasticsearch-更新和删除文档的过程。" aria-label="详细描述一下 Elasticsearch 更新和删除文档的过程。"><!---->详细描述一下 Elasticsearch 更新和删除文档的过程。<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#详细描述一下-elasticsearch-搜索的过程。" aria-label="详细描述一下 Elasticsearch 搜索的过程。"><!---->详细描述一下 Elasticsearch 搜索的过程。<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#elasticsearch-在部署时-对-linux-的设置有哪些优化方法-2" aria-label="Elasticsearch 在部署时，对 Linux 的设置有哪些优化方法？"><!---->Elasticsearch 在部署时，对 Linux 的设置有哪些优化方法？<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#对于-gc-方面-在使用-elasticsearch-时要注意什么" aria-label="对于 GC 方面，在使用 Elasticsearch 时要注意什么？"><!---->对于 GC 方面，在使用 Elasticsearch 时要注意什么？<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#elasticsearch-对于大数据量-上亿量级-的聚合如何实现" aria-label="Elasticsearch 对于大数据量（上亿量级）的聚合如何实现？"><!---->Elasticsearch 对于大数据量（上亿量级）的聚合如何实现？<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#在并发情况下-elasticsearch-如果保证读写一致" aria-label="在并发情况下，Elasticsearch 如果保证读写一致？"><!---->在并发情况下，Elasticsearch 如果保证读写一致？<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#如何监控-elasticsearch-集群状态" aria-label="如何监控 Elasticsearch 集群状态？"><!---->如何监控 Elasticsearch 集群状态？<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#介绍下你们电商搜索的整体技术架构。" aria-label="介绍下你们电商搜索的整体技术架构。"><!---->介绍下你们电商搜索的整体技术架构。<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#介绍一下你们的个性化搜索方案" aria-label="介绍一下你们的个性化搜索方案？"><!---->介绍一下你们的个性化搜索方案？<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#是否了解字典树" aria-label="是否了解字典树？"><!---->是否了解字典树？<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html#拼写纠错是如何实现的" aria-label="拼写纠错是如何实现的？"><!---->拼写纠错是如何实现的？<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul><!--]--></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Kafka</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Memcached</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Mongodb</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Mysql</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Nginx</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Rabbitmq</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Redis</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Rocketmq</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Elasticsearch面试题</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://xiaobaidebug.top/" target="_blank" rel="noopener noreferrer">小白debug</a></span><span property="author" content="小白debug"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-02-13T08:18:41.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 26 分钟</span><meta property="timeRequired" content="PT26M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#文档查询步骤顺序">文档查询步骤顺序</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#单个文档">单个文档</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#多个文档">多个文档</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#您能解释一下-x-pack-for-elasticsearch-的功能和重要性吗">您能解释一下 X-Pack for Elasticsearch 的功能和重要性吗？</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#elasticsearch-中的节点-比如共-20-个-其中的-10-个选了-一个-master-另外-10-个选了另一个-master-怎么办">Elasticsearch  中的节点（比如共  20  个），其中的  10  个选了 一个 master，另外  10  个选了另一个  master，怎么办？</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#解释一下-elasticsearch-集群中的-索引的概念">解释一下  Elasticsearch 集群中的  索引的概念  ？</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#你可以列出-elasticsearch-各种类型的分析器吗">你可以列出  Elasticsearch  各种类型的分析器吗？</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#解释一下-elasticsearch-node">解释一下  Elasticsearch Node？</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#在安装-elasticsearch-时-请说明不同的软件包及其重要性">在安装 Elasticsearch 时，请说明不同的软件包及其重要性？</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#elasticsearch-在部署时-对-linux-的设置有哪些优化方法">Elasticsearch 在部署时，对 Linux 的设置有哪些优化方法？</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#请解释有关-elasticsearch-的-nrt">请解释有关  Elasticsearch 的  NRT？</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#elasticsearch-的-document-设计">elasticsearch  的  document 设计</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#elasticsearch-了解多少-说说你们公司-es-的集群架构-索引数据大小-分片有多少-以及一些调优手段-。">elasticsearch 了解多少，说说你们公司 es 的集群架构，索引数据大小，分片有多少，以及一些调优手段 。</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#elasticsearch-的倒排索引是什么">elasticsearch 的倒排索引是什么</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#elasticsearch-索引数据多了怎么办-如何调优-部署">elasticsearch 索引数据多了怎么办，如何调优，部署</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#elasticsearch-是如何实现-master-选举的">elasticsearch 是如何实现 master 选举的</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#详细描述一下-elasticsearch-索引文档的过程">详细描述一下 Elasticsearch 索引文档的过程</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#详细描述一下-elasticsearch-搜索的过程">详细描述一下 Elasticsearch 搜索的过程？</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#elasticsearch-在部署时-对-linux-的设置有哪些优化方法-1">Elasticsearch 在部署时，对 Linux 的设置有哪些优化方法</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#lucence-内部结构是什么">lucence 内部结构是什么？</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#elasticsearch-是如何实现-master-选举的-1">Elasticsearch 是如何实现 Master 选举的？</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#elasticsearch-中的节点-比如共-20-个-其中的-10-个">Elasticsearch 中的节点（比如共 20 个），其中的 10 个</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#客户端在和集群连接时-如何选择特定的节点执行请求的">客户端在和集群连接时，如何选择特定的节点执行请求的？</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#详细描述一下-elasticsearch-索引文档的过程。">详细描述一下 Elasticsearch 索引文档的过程。</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#详细描述一下-elasticsearch-更新和删除文档的过程。">详细描述一下 Elasticsearch 更新和删除文档的过程。</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#详细描述一下-elasticsearch-搜索的过程。">详细描述一下 Elasticsearch 搜索的过程。</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#elasticsearch-在部署时-对-linux-的设置有哪些优化方法-2">Elasticsearch 在部署时，对 Linux 的设置有哪些优化方法？</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#对于-gc-方面-在使用-elasticsearch-时要注意什么">对于 GC 方面，在使用 Elasticsearch 时要注意什么？</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#elasticsearch-对于大数据量-上亿量级-的聚合如何实现">Elasticsearch 对于大数据量（上亿量级）的聚合如何实现？</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#在并发情况下-elasticsearch-如果保证读写一致">在并发情况下，Elasticsearch 如果保证读写一致？</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#如何监控-elasticsearch-集群状态">如何监控 Elasticsearch 集群状态？</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#介绍下你们电商搜索的整体技术架构。">介绍下你们电商搜索的整体技术架构。</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#介绍一下你们的个性化搜索方案">介绍一下你们的个性化搜索方案？</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#是否了解字典树">是否了解字典树？</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#拼写纠错是如何实现的">拼写纠错是如何实现的？</a></li><!----><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!--[--><!----><!--]--><div class="theme-hope-content"><h1 id="elasticsearch面试题" tabindex="-1"><a class="header-anchor" href="#elasticsearch面试题"><span>Elasticsearch面试题</span></a></h1><h2 id="文档查询步骤顺序" tabindex="-1"><a class="header-anchor" href="#文档查询步骤顺序"><span>文档查询步骤顺序</span></a></h2><blockquote><p>先看下整体的查询流程</p></blockquote><h3 id="单个文档" tabindex="-1"><a class="header-anchor" href="#单个文档"><span>单个文档</span></a></h3><p>以下是从主分片或者副本分片检索文档的步骤顺序：</p><figure><img src="https://cdn.xiaobaidebug.top/es-th-2-21.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><ol><li>客户端向 Node 1 发送获取请求。</li><li>节点使用文档的 _id 来确定文档属于分片 0 。分片 0 的副本分片存在于所有的三个节点上。 在这种情况下，它将请求转发到 Node 2 。</li><li>Node 2 将文档返回给 Node 1 ，然后将文档返回给客户端。</li></ol><p>在处理读取请求时，协调结点在每次请求的时候都会通过轮询所有的副本分片来达到负载均衡。</p><p>在文档被检索时，已经被索引的文档可能已经存在于主分片上但是还没有复制到副本分片。 在这种情况下，副本分片可能会报告文档不存在，但是主分片可能成功返回文档。 一旦索引请求成功返回给用户，文档在主分片和副本分片都是可用的。</p><h3 id="多个文档" tabindex="-1"><a class="header-anchor" href="#多个文档"><span>多个文档</span></a></h3><p>使用 mget 取回多个文档的步骤顺序：</p><figure><img src="https://cdn.xiaobaidebug.top/es-th-2-22.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>以下是使用单个 mget 请求取回多个文档所需的步骤顺序：</p><ol><li>客户端向 Node 1 发送 mget 请求。</li><li>Node 1 为每个分片构建多文档获取请求，然后并行转发这些请求到托管在每个所需的主分片或者副本分片的节点上。一旦收到所有答复， Node 1 构建响应并将其返回给客户端。</li></ol><h2 id="您能解释一下-x-pack-for-elasticsearch-的功能和重要性吗" tabindex="-1"><a class="header-anchor" href="#您能解释一下-x-pack-for-elasticsearch-的功能和重要性吗"><span>您能解释一下 X-Pack for Elasticsearch 的功能和重要性吗？</span></a></h2><p>X-Pack 是与 Elasticsearch 一起安装的扩展程序。</p><p>X-Pack 的各种功能包括安全性（基于角色的访问，特权/权限，角色和用户安 全性），监视，报告，警报等。</p><h2 id="elasticsearch-中的节点-比如共-20-个-其中的-10-个选了-一个-master-另外-10-个选了另一个-master-怎么办" tabindex="-1"><a class="header-anchor" href="#elasticsearch-中的节点-比如共-20-个-其中的-10-个选了-一个-master-另外-10-个选了另一个-master-怎么办"><span>Elasticsearch 中的节点（比如共 20 个），其中的 10 个选了 一个 master，另外 10 个选了另一个 master，怎么办？</span></a></h2><ul><li>当集群 master 候选数量不小于 3 个时，可以通过设置最少投票通过数量</li></ul><p>（discovery.zen.minimum_master_nodes）超过所有候选节点一半以上 来解决脑裂问题；</p><ul><li>当候选数量为两个时，只能修改为唯一的一个 master 候选，其他作为data 节点，避免脑裂问题。</li></ul><h2 id="解释一下-elasticsearch-集群中的-索引的概念" tabindex="-1"><a class="header-anchor" href="#解释一下-elasticsearch-集群中的-索引的概念"><span>解释一下 Elasticsearch 集群中的 索引的概念 ？</span></a></h2><p>Elasticsearch 集群可以包含多个索引，与关系数据库相比，它们相当于数据库 表。</p><h2 id="你可以列出-elasticsearch-各种类型的分析器吗" tabindex="-1"><a class="header-anchor" href="#你可以列出-elasticsearch-各种类型的分析器吗"><span>你可以列出 Elasticsearch 各种类型的分析器吗？</span></a></h2><p>Elasticsearch Analyzer 的类型为内置分析器和自定义分析器。</p><p><strong>Standard Analyzer</strong> 标准分析器是默认分词器，如果未指定，则使用该分词器。 它基于 Unicode 文本分割算法，适用于大多数语言。</p><p><strong>Whitespace Analyzer</strong></p><p>基于空格字符切词。</p><p><strong>Stop Analyzer</strong></p><p>在 simple Analyzer 的基础上，移除停用词。</p><p><strong>Keyword Analyzer</strong> 不切词，将输入的整个串一起返回。</p><p><strong>自定义分词器的模板</strong></p><p>自定义分词器的在 Mapping 的 Setting 部分设置：</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>PUT my\_custom\_index 
<span class="token punctuation">{</span>
    <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;analysis&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;char\_filter&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>

            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;tokenizer&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>

            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;filter&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>

            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>

            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中： “char_filter”:{},——对应字符过滤部分； “tokenizer”:{},——对应文本切分为分词部分；</p><p>“filter”:{},——对应分词后再过滤部分； “analyzer”:{}——对应分词器组成部分，其中会包含：1. 2. 3。</p><h2 id="解释一下-elasticsearch-node" tabindex="-1"><a class="header-anchor" href="#解释一下-elasticsearch-node"><span>解释一下 Elasticsearch Node？</span></a></h2><p>节点是 Elasticsearch 的实例。实际业务中，我们会说：ES 集群包含 3 个节 点、7 个节点。</p><p>这里节点实际就是：一个独立的 Elasticsearch 进程，一般将一个节点部署到 一台独立的服务器或者虚拟机、容器中。 不同节点根据角色不同，可以划分为：</p><p><strong>主节点</strong></p><p>帮助配置和管理在整个集群中添加和删除节点。</p><p><strong>数据节点</strong></p><p>存储数据并执行诸如 CRUD（创建/读取/更新/删除）操作，对数据进行搜索和 聚合的操作。</p><p><strong>客户端节点</strong>（或者说：协调节点）</p><p>将集群请求转发到主节点，将与数据相 关的请求转发到数据节点。</p><p><strong>摄取节点</strong></p><p>用于在索引之前对文档进行预处理。</p><h2 id="在安装-elasticsearch-时-请说明不同的软件包及其重要性" tabindex="-1"><a class="header-anchor" href="#在安装-elasticsearch-时-请说明不同的软件包及其重要性"><span>在安装 Elasticsearch 时，请说明不同的软件包及其重要性？</span></a></h2><p>这个貌似没什么好说的，去官方文档下载对应操作系统安装包即可。 部分功能是收费的，如机器学习、高级别 kerberos 认证安全等选型要知悉。</p><h2 id="elasticsearch-在部署时-对-linux-的设置有哪些优化方法" tabindex="-1"><a class="header-anchor" href="#elasticsearch-在部署时-对-linux-的设置有哪些优化方法"><span>Elasticsearch 在部署时，对 Linux 的设置有哪些优化方法？</span></a></h2><p>关闭缓存 swap;</p><p>堆内存设置为：Min（节点内存/2, 32GB）;</p><p>设置最大文件句柄数；</p><p>线程池+队列大小根据业务需要做调整；</p><p>磁盘存储 raid 方式——存储有条件使用 RAID10，增加单节点性能以及避 免单节点存储故障。</p><h2 id="请解释有关-elasticsearch-的-nrt" tabindex="-1"><a class="header-anchor" href="#请解释有关-elasticsearch-的-nrt"><span>请解释有关 Elasticsearch 的 NRT？</span></a></h2><p>从文档索引（写入）到可搜索到之间的延迟默认一秒钟，因此 Elasticsearch 是 近实时（NRT）搜索平台。</p><p>也就是说：文档写入，最快一秒钟被索引到，不能再快了。 写入调优的时候，我们通常会动态调整：refresh_interval = 30s 或者更达 值，以使得写入数据更晚一点时间被搜索到。</p><h2 id="elasticsearch-的-document-设计" tabindex="-1"><a class="header-anchor" href="#elasticsearch-的-document-设计"><span>elasticsearch 的 document 设计</span></a></h2><p>在使用 es 时 避免使用复杂的查询语句（Join 、聚合），就是在建立索引时， 就根据查询语句建立好对应的元数据。</p><h2 id="elasticsearch-了解多少-说说你们公司-es-的集群架构-索引数据大小-分片有多少-以及一些调优手段-。" tabindex="-1"><a class="header-anchor" href="#elasticsearch-了解多少-说说你们公司-es-的集群架构-索引数据大小-分片有多少-以及一些调优手段-。"><span>elasticsearch 了解多少，说说你们公司 es 的集群架构，索引数据大小，分片有多少，以及一些调优手段 。</span></a></h2><p>面试官：想了解应聘者之前公司接触的 ES 使用场景、规模，有没有做过比较大</p><p>规模的索引设计、规划、调优。</p><p>解答：</p><p>如实结合自己的实践场景回答即可。</p><p>比如：ES 集群架构 13 个节点，索引根据通道不同共 20+索引，根据日期，每日</p><p>递增 20+，索引：10 分片，每日递增 1 亿+数据，</p><p>每个通道每天索引大小控制：150GB 之内。</p><p>仅索引层面调优手段：</p><p><strong>1.1、设计阶段调优</strong></p><p>1、根据业务增量需求，采取基于日期模板创建索引，通过 roll over API 滚动索</p><p>引；</p><p>2、使用别名进行索引管理；</p><p>3、每天凌晨定时对索引做 force_merge 操作，以释放空间；</p><p>4、采取冷热分离机制，热数据存储到 SSD，提高检索效率；冷数据定期进行 shrink</p><p>操作，以缩减存储；</p><p>5、采取 curator 进行索引的生命周期管理；</p><p>6、仅针对需要分词的字段，合理的设置分词器；</p><p>7、Mapping 阶段充分结合各个字段的属性，是否需要检索、是否需要存储等。……..</p><p><strong>1.2、写入调优</strong></p><p>1、写入前副本数设置为 0；</p><p>2、写入前关闭 refresh_interval 设置为-1，禁用刷新机制；</p><p>3、写入过程中：采取 bulk 批量写入；</p><p>4、写入后恢复副本数和刷新间隔；</p><p>5、尽量使用自动生成的 id。</p><p><strong>1.3、查询调优</strong></p><p>1、禁用 wildcard；</p><p>2、禁用批量 terms（成百上千的场景）；</p><p>3、充分利用倒排索引机制，能 keyword 类型尽量 keyword；</p><p>4、数据量大时候，可以先基于时间敲定索引再检索；</p><p>5、设置合理的路由机制。</p><p><strong>1.4、其他调优</strong></p><p>部署调优，业务调优等。</p><p>上面的提及一部分，面试者就基本对你之前的实践或者运维经验有所评估了。</p><h2 id="elasticsearch-的倒排索引是什么" tabindex="-1"><a class="header-anchor" href="#elasticsearch-的倒排索引是什么"><span>elasticsearch 的倒排索引是什么</span></a></h2><p>面试官：想了解你对基础概念的认知。</p><p>解答：通俗解释一下就可以。</p><p>传统的我们的检索是通过文章，逐个遍历找到对应关键词的位置。</p><p>而倒排索引，是通过分词策略，形成了词和文章的映射关系表，这种词典+映射表</p><p>即为倒排索引。</p><p>有了倒排索引，就能实现 o（1）时间复杂度的效率检索文章了，极大的提高了</p><p>检索效率。</p><figure><img src="https://pic4.zhimg.com/80/v2-43542fcc0daf345b92c5a674c4197e8b_1440w.webp" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>学术的解答方式：</p><p>倒排索引，相反于一篇文章包含了哪些词，它从词出发，记载了这个词在哪些文</p><p>档中出现过，由两部分组成——词典和倒排表。</p><p>加分项：倒排索引的底层实现是基于：FST（Finite State Transducer）数据结</p><p>构。</p><p>lucene 从 4+版本后开始大量使用的数据结构是 FST。FST 有两个优点：</p><p>1、空间占用小。通过对词典中单词前缀和后缀的重复利用，压缩了存储空间；</p><p>2、查询速度快。O(len(str))的查询时间复杂度。</p><h2 id="elasticsearch-索引数据多了怎么办-如何调优-部署" tabindex="-1"><a class="header-anchor" href="#elasticsearch-索引数据多了怎么办-如何调优-部署"><span>elasticsearch 索引数据多了怎么办，如何调优，部署</span></a></h2><p>面试官：想了解大数据量的运维能力。</p><p>解答：索引数据的规划，应在前期做好规划，正所谓“设计先行，编码在后”，</p><p>这样才能有效的避免突如其来的数据激增导致集群处理能力不足引发的线上客户</p><p>检索或者其他业务受到影响。</p><p>如何调优，正如问题 1 所说，这里细化一下：</p><p><strong>3.1 动态索引层面</strong></p><p>基于模板+时间+rollover api 滚动创建索引，举例：设计阶段定义：blog 索</p><p>引的模板格式为：blog_index_时间戳的形式，每天递增数据。</p><p>这样做的好处：不至于数据量激增导致单个索引数据量非常大，接近于上线 2 的</p><p>32 次幂-1，索引存储达到了 TB+甚至更大。</p><p>一旦单个索引很大，存储等各种风险也随之而来，所以要提前考虑+及早避免。</p><p><strong>3.2 存储层面</strong></p><p>冷热数据分离存储，热数据（比如最近 3 天或者一周的数据），其余为冷数据。</p><p>对于冷数据不会再写入新数据，可以考虑定期 force_merge 加 shrink 压缩操作，</p><p>节省存储空间和检索效率。</p><p><strong>3.3 部署层面</strong></p><p>一旦之前没有规划，这里就属于应急策略。</p><p>结合 ES 自身的支持动态扩展的特点，动态新增机器的方式可以缓解集群压力，注</p><p>意：如果之前主节点等规划合理，不需要重启集群也能完成动态新增的。</p><h2 id="elasticsearch-是如何实现-master-选举的" tabindex="-1"><a class="header-anchor" href="#elasticsearch-是如何实现-master-选举的"><span>elasticsearch 是如何实现 master 选举的</span></a></h2><p>面试官：想了解 ES 集群的底层原理，不再只关注业务层面了。</p><p>解答：</p><p>前置前提：</p><p>1、只有候选主节点（master：true）的节点才能成为主节点。</p><p>2、最小主节点数（min_master_nodes）的目的是防止脑裂。</p><p>这个我看了各种网上分析的版本和源码分析的书籍，云里雾里。</p><p>核对了一下代码，核心入口为 findMaster，选择主节点成功返回对应 Master，否</p><p>则返回 null。选举流程大致描述如下：</p><p>第一步：确认候选主节点数达标，elasticsearch.yml 设置的值</p><p>discovery.zen.minimum_master_nodes；</p><p>第二步：比较：先判定是否具备 master 资格，具备候选主节点资格的优先返回；</p><p>若两节点都为候选主节点，则 id 小的值会主节点。注意这里的 id 为 string 类型。</p><p>题外话：获取节点 id 的方法。</p><figure><img src="https://pic3.zhimg.com/80/v2-8dfcfedc2840b6a405195899437ebeaa_1440w.webp" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h2 id="详细描述一下-elasticsearch-索引文档的过程" tabindex="-1"><a class="header-anchor" href="#详细描述一下-elasticsearch-索引文档的过程"><span>详细描述一下 Elasticsearch 索引文档的过程</span></a></h2><p>面试官：想了解 ES 的底层原理，不再只关注业务层面了。</p><p>解答：</p><p>这里的索引文档应该理解为文档写入 ES，创建索引的过程。</p><p>文档写入包含：单文档写入和批量 bulk 写入，这里只解释一下：单文档写入流程。</p><p>记住官方文档中的这个图。</p><figure><img src="https://pic3.zhimg.com/80/v2-8b8eccec501800436783e3bfe2c8ad86_1440w.webp" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>第一步：客户写集群某节点写入数据，发送请求。（如果没有指定路由/协调节点，</p><p>请求的节点扮演路由节点的角色。）</p><p>第二步：节点 1 接受到请求后，使用文档_id 来确定文档属于分片 0。请求会被转</p><p>到另外的节点，假定节点 3。因此分片 0 的主分片分配到节点 3 上。</p><p>第三步：节点 3 在主分片上执行写操作，如果成功，则将请求并行转发到节点 1</p><p>和节点 2 的副本分片上，等待结果返回。所有的副本分片都报告成功，节点 3 将</p><p>向协调节点（节点 1）报告成功，节点 1 向请求客户端报告写入成功。</p><p>如果面试官再问：第二步中的文档获取分片的过程？</p><p>回答：借助路由算法获取，路由算法就是根据路由和文档 id 计算目标的分片 id 的</p><p>过程。</p><p>1shard = hash(_routing) % (num_of_primary_shards)</p><h2 id="详细描述一下-elasticsearch-搜索的过程" tabindex="-1"><a class="header-anchor" href="#详细描述一下-elasticsearch-搜索的过程"><span>详细描述一下 Elasticsearch 搜索的过程？</span></a></h2><p>面试官：想了解 ES 搜索的底层原理，不再只关注业务层面了。</p><p>解答：</p><p>搜索拆解为“query then fetch” 两个阶段。</p><p><strong>query 阶段的目的</strong>：定位到位置，但不取。</p><p>步骤拆解如下：</p><p>1、假设一个索引数据有 5 主+1 副本 共 10 分片，一次请求会命中（主或者副本</p><p>分片中）的一个。</p><p>2、每个分片在本地进行查询，结果返回到本地有序的优先队列中。</p><p>3、第 （2）步骤的结果发送到协调节点，协调节点产生一个全局的排序列表。</p><p><strong>fetch 阶段的目的</strong>：取数据。</p><p>路由节点获取所有文档，返回给客户端。</p><h2 id="elasticsearch-在部署时-对-linux-的设置有哪些优化方法-1" tabindex="-1"><a class="header-anchor" href="#elasticsearch-在部署时-对-linux-的设置有哪些优化方法-1"><span>Elasticsearch 在部署时，对 Linux 的设置有哪些优化方法</span></a></h2><p>面试官：想了解对 ES 集群的运维能力。</p><p>解答：</p><p>1、关闭缓存 swap;</p><p>2、堆内存设置为：Min（节点内存/2, 32GB）;</p><p>3、设置最大文件句柄数；</p><p>4、线程池+队列大小根据业务需要做调整；</p><p>5、磁盘存储 raid 方式——存储有条件使用 RAID10，增加单节点性能以及避免单</p><p>节点存储故障。</p><h2 id="lucence-内部结构是什么" tabindex="-1"><a class="header-anchor" href="#lucence-内部结构是什么"><span>lucence 内部结构是什么？</span></a></h2><p>面试官：想了解你的知识面的广度和深度。</p><p>解答：</p><figure><img src="https://pic3.zhimg.com/80/v2-d4c024788023660e7a19c8981b5ce2fa_1440w.webp" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>Lucene 是有索引和搜索的两个过程，包含索引创建，索引，搜索三个要点。可以</p><p>基于这个脉络展开一些。</p><p>最近面试一些公司，被问到的关于 Elasticsearch 和搜索引擎相关的问题，以及自</p><p>己总结的回答。</p><h2 id="elasticsearch-是如何实现-master-选举的-1" tabindex="-1"><a class="header-anchor" href="#elasticsearch-是如何实现-master-选举的-1"><span>Elasticsearch 是如何实现 Master 选举的？</span></a></h2><p>1、Elasticsearch 的选主是 ZenDiscovery 模块负责的，主要包含 Ping（节点之</p><p>间通过这个 RPC 来发现彼此）和 Unicast（单播模块包含一个主机列表以控制哪</p><p>些节点需要 ping 通）这两部分；</p><p>2、对所有可以成为 master 的节点（<strong>node.master: true</strong>）根据 nodeId 字典排</p><p>序，每次选举每个节点都把自己所知道节点排一次序，然后选出第一个（第 0 位）</p><p>节点，暂且认为它是 master 节点。</p><p>3、如果对某个节点的投票数达到一定的值（可以成为 master 节点数 n/2+1）并</p><p>且该节点自己也选举自己，那这个节点就是 master。否则重新选举一直到满足上</p><p>述条件。</p><p>4、补充：master 节点的职责主要包括集群、节点和索引的管理，不负责文档级</p><p>别的管理；data 节点可以关闭 http 功能*。</p><h2 id="elasticsearch-中的节点-比如共-20-个-其中的-10-个" tabindex="-1"><a class="header-anchor" href="#elasticsearch-中的节点-比如共-20-个-其中的-10-个"><span>Elasticsearch 中的节点（比如共 20 个），其中的 10 个</span></a></h2><p><strong>选了一个 master，另外 10 个选了另一个 master，怎么办？</strong></p><p>1、当集群 master 候选数量不小于 3 个时，可以通过设置最少投票通过数量</p><p>（<strong>discovery.zen.minimum_master_nodes</strong>）超过所有候选节点一半以上来解</p><p>决脑裂问题；</p><p>2、当候选数量为两个时，只能修改为唯一的一个 master 候选，其他作为 data</p><p>节点，避免脑裂问题。</p><h2 id="客户端在和集群连接时-如何选择特定的节点执行请求的" tabindex="-1"><a class="header-anchor" href="#客户端在和集群连接时-如何选择特定的节点执行请求的"><span>客户端在和集群连接时，如何选择特定的节点执行请求的？</span></a></h2><p>1、TransportClient 利用 transport 模块远程连接一个 elasticsearch 集群。它并</p><p>不加入到集群中，只是简单的获得一个或者多个初始化的 transport 地址，并以 <strong>轮</strong></p><p><strong>询</strong> 的方式与这些地址进行通信。</p><h2 id="详细描述一下-elasticsearch-索引文档的过程。" tabindex="-1"><a class="header-anchor" href="#详细描述一下-elasticsearch-索引文档的过程。"><span>详细描述一下 Elasticsearch 索引文档的过程。</span></a></h2><p>协调节点默认使用文档 ID 参与计算（也支持通过 routing），以便为路由提供合</p><p>适的分片。</p><p>shard = hash(document_id) % (num_of_primary_shards)</p><p>1、当分片所在的节点接收到来自协调节点的请求后，会将请求写入到 Memory</p><p>Buffer，然后定时（默认是每隔 1 秒）写入到 Filesystem Cache，这个从 Momery</p><p>Buffer 到 Filesystem Cache 的过程就叫做 refresh；</p><p>2、当然在某些情况下，存在 Momery Buffer 和 Filesystem Cache 的数据可能会</p><p>丢失，ES 是通过 translog 的机制来保证数据的可靠性的。其实现机制是接收到请</p><p>求后，同时也会写入到 translog 中，当 Filesystem cache 中的数据写入到磁盘中</p><p>时，才会清除掉，这个过程叫做 flush；</p><p>3、在 flush 过程中，内存中的缓冲将被清除，内容被写入一个新段，段的 fsync</p><p>将创建一个新的提交点，并将内容刷新到磁盘，旧的 translog 将被删除并开始一</p><p>个新的 translog。</p><p>4、flush 触发的时机是定时触发（默认 30 分钟）或者 translog 变得太大（默认</p><p>为 512M）时；</p><figure><img src="https://pic2.zhimg.com/80/v2-98fc4f1cd2b3c13e56dead5850e9db95_1440w.webp" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>补充：关于 Lucene 的 Segement：</strong></p><p>1、Lucene 索引是由多个段组成，段本身是一个功能齐全的倒排索引。</p><p>2、段是不可变的，允许 Lucene 将新的文档增量地添加到索引中，而不用从头重</p><p>建索引。</p><p>3、对于每一个搜索请求而言，索引中的所有段都会被搜索，并且每个段会消耗</p><p>CPU 的时钟周、文件句柄和内存。这意味着段的数量越多，搜索性能会越低。</p><p>4、为了解决这个问题，Elasticsearch 会合并小段到一个较大的段，提交新的合并</p><p>段到磁盘，并删除那些旧的小段。</p><h2 id="详细描述一下-elasticsearch-更新和删除文档的过程。" tabindex="-1"><a class="header-anchor" href="#详细描述一下-elasticsearch-更新和删除文档的过程。"><span>详细描述一下 Elasticsearch 更新和删除文档的过程。</span></a></h2><p>1、删除和更新也都是写操作，但是 Elasticsearch 中的文档是不可变的，因此不</p><p>能被删除或者改动以展示其变更；</p><p>2、磁盘上的每个段都有一个相应的.del 文件。当删除请求发送后，文档并没有真</p><p>的被删除，而是在.del 文件中被标记为删除。该文档依然能匹配查询，但是会在</p><p>结果中被过滤掉。当段合并时，在.del 文件中被标记为删除的文档将不会被写入</p><p>新段。</p><p>3、在新的文档被创建时，Elasticsearch 会为该文档指定一个版本号，当执行更新</p><p>时，旧版本的文档在.del 文件中被标记为删除，新版本的文档被索引到一个新段。</p><p>旧版本的文档依然能匹配查询，但是会在结果中被过滤掉。</p><h2 id="详细描述一下-elasticsearch-搜索的过程。" tabindex="-1"><a class="header-anchor" href="#详细描述一下-elasticsearch-搜索的过程。"><span>详细描述一下 Elasticsearch 搜索的过程。</span></a></h2><p>1、搜索被执行成一个两阶段过程，我们称之为 Query Then Fetch；</p><p>2、在初始<strong>查询阶段</strong>时，查询会广播到索引中每一个分片拷贝（主分片或者副本分</p><p>片）。 每个分片在本地执行搜索并构建一个匹配文档的大小为 from + size 的</p><p>优先队列。</p><p>PS：在搜索的时候是会查询 Filesystem Cache 的，但是有部分数据还在 Memory</p><p>Buffer，所以搜索是近实时的。</p><p>3、每个分片返回各自优先队列中 <strong>所有文档的 ID 和排序值</strong> 给协调节点，它合并</p><p>这些值到自己的优先队列中来产生一个全局排序后的结果列表。</p><p>4、接下来就是 <strong>取回阶段</strong>，协调节点辨别出哪些文档需要被取回并向相关的分片</p><p>提交多个 GET 请求。每个分片加载并 丰富 文档，如果有需要的话，接着返回</p><p>文档给协调节点。一旦所有的文档都被取回了，协调节点返回结果给客户端。</p><p>5、补充：Query Then Fetch 的搜索类型在文档相关性打分的时候参考的是本分</p><p>片的数据，这样在文档数量较少的时候可能不够准确，DFS Query Then Fetch 增</p><p>加了一个预查询的处理，询问 Term 和 Document frequency，这个评分更准确，</p><p>但是性能会变差。*</p><figure><img src="https://cdn.xiaobaidebug.top/v2-aac5b983cb1aa9ec2c81e6624292e469_1440w.webp" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h2 id="elasticsearch-在部署时-对-linux-的设置有哪些优化方法-2" tabindex="-1"><a class="header-anchor" href="#elasticsearch-在部署时-对-linux-的设置有哪些优化方法-2"><span>Elasticsearch 在部署时，对 Linux 的设置有哪些优化方法？</span></a></h2><p>1、64 GB 内存的机器是非常理想的， 但是 32 GB 和 16 GB 机器也是很常见的。</p><p>少于 8 GB 会适得其反。</p><p>2、如果你要在更快的 CPUs 和更多的核心之间选择，选择更多的核心更好。多</p><p>个内核提供的额外并发远胜过稍微快一点点的时钟频率。</p><p>3、如果你负担得起 SSD，它将远远超出任何旋转介质。 基于 SSD 的节点，查</p><p>询和索引性能都有提升。如果你负担得起，SSD 是一个好的选择。</p><p>4、即使数据中心们近在咫尺，也要避免集群跨越多个数据中心。绝对要避免集群</p><p>跨越大的地理距离。</p><p>5、请确保运行你应用程序的 JVM 和服务器的 JVM 是完全一样的。 在</p><p>Elasticsearch 的几个地方，使用 Java 的本地序列化。</p><p>6、通过设置 gateway.recover_after_nodes、gateway.expected_nodes、</p><p>gateway.recover_after_time 可以在集群重启的时候避免过多的分片交换，这可</p><p>能会让数据恢复从数个小时缩短为几秒钟。</p><p>7、Elasticsearch 默认被配置为使用单播发现，以防止节点无意中加入集群。只</p><p>有在同一台机器上运行的节点才会自动组成集群。最好使用单播代替组播。</p><p>8、不要随意修改垃圾回收器（CMS）和各个线程池的大小。</p><p>9、把你的内存的（少于）一半给 Lucene（但不要超过 32 GB！），通过</p><p>ES_HEAP_SIZE 环境变量设置。</p><p>10、内存交换到磁盘对服务器性能来说是致命的。如果内存交换到磁盘上，一个</p><p>100 微秒的操作可能变成 10 毫秒。 再想想那么多 10 微秒的操作时延累加起</p><p>来。 不难看出 swapping 对于性能是多么可怕。</p><p>11、Lucene 使用了大量 的文件。同时，Elasticsearch 在节点和 HTTP 客户端</p><p>之间进行通信也使用了大量的套接字。 所有这一切都需要足够的文件描述符。你</p><p>应该增加你的文件描述符，设置一个很大的值，如 64,000。</p><p><strong>补充：索引阶段性能提升方法</strong></p><p>1、使用批量请求并调整其大小：每次批量数据 5–15 MB 大是个不错的起始点。</p><p>2、存储：使用 SSD</p><p>3、段和合并：Elasticsearch 默认值是 20 MB/s，对机械磁盘应该是个不错的设</p><p>置。如果你用的是 SSD，可以考虑提高到 100–200 MB/s。如果你在做批量导入，</p><p>完全不在意搜索，你可以彻底关掉合并限流。另外还可以增加</p><p>index.translog.flush_threshold_size 设置，从默认的 512 MB 到更大一些的</p><p>值，比如 1 GB，这可以在一次清空触发的时候在事务日志里积累出更大的段。</p><p>4、如果你的搜索结果不需要近实时的准确度，考虑把每个索引的</p><p>index.refresh_interval 改到 30s。</p><p>5、如果你在做大批量导入，考虑通过设置 index.number_of_replicas: 0 关闭副</p><p>本。</p><h2 id="对于-gc-方面-在使用-elasticsearch-时要注意什么" tabindex="-1"><a class="header-anchor" href="#对于-gc-方面-在使用-elasticsearch-时要注意什么"><span>对于 GC 方面，在使用 Elasticsearch 时要注意什么？</span></a></h2><p>1、SEE：<a href="https://link.zhihu.com/?target=https%3A//elasticsearch.cn/article/32" target="_blank" rel="noopener noreferrer">https://elasticsearch.cn/article/32<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>2、倒排词典的索引需要常驻内存，无法 GC，需要监控 data node 上 segment</p><p>memory 增长趋势。</p><p>3、各类缓存，field cache, filter cache, indexing cache, bulk queue 等等，要</p><p>设置合理的大小，并且要应该根据最坏的情况来看 heap 是否够用，也就是各类缓</p><p>存全部占满的时候，还有 heap 空间可以分配给其他任务吗？避免采用 clear cache</p><p>等“自欺欺人”的方式来释放内存。</p><p>4、避免返回大量结果集的搜索与聚合。确实需要大量拉取数据的场景，可以采用</p><p>scan &amp; scroll api 来实现。</p><p>5、cluster stats 驻留内存并无法水平扩展，超大规模集群可以考虑分拆成多个集</p><p>群通过 tribe node 连接。</p><p>6、想知道 heap 够不够，必须结合实际应用场景，并对集群的 heap 使用情况做</p><p>持续的监控。</p><h2 id="elasticsearch-对于大数据量-上亿量级-的聚合如何实现" tabindex="-1"><a class="header-anchor" href="#elasticsearch-对于大数据量-上亿量级-的聚合如何实现"><span>Elasticsearch 对于大数据量（上亿量级）的聚合如何实现？</span></a></h2><p>Elasticsearch 提供的首个近似聚合是 cardinality 度量。它提供一个字段的基数，</p><p>即该字段的 distinct 或者 unique 值的数目。它是基于 HLL 算法的。HLL 会先对</p><p>我们的输入作哈希运算，然后根据哈希运算的结果中的 bits 做概率估算从而得到</p><p>基数。其特点是：可配置的精度，用来控制内存的使用（更精确 ＝ 更多内存）；</p><p>小的数据集精度是非常高的；我们可以通过配置参数，来设置去重需要的固定内</p><p>存使用量。无论数千还是数十亿的唯一值，内存使用量只与你配置的精确度相关。</p><h2 id="在并发情况下-elasticsearch-如果保证读写一致" tabindex="-1"><a class="header-anchor" href="#在并发情况下-elasticsearch-如果保证读写一致"><span>在并发情况下，Elasticsearch 如果保证读写一致？</span></a></h2><p>1、可以通过版本号使用乐观并发控制，以确保新版本不会被旧版本覆盖，由应用</p><p>层来处理具体的冲突；</p><p>2、另外对于写操作，一致性级别支持 quorum/one/all，默认为 quorum，即只</p><p>有当大多数分片可用时才允许写操作。但即使大多数可用，也可能存在因为网络</p><p>等原因导致写入副本失败，这样该副本被认为故障，分片将会在一个不同的节点</p><p>上重建。</p><p>3、对于读操作，可以设置 replication 为 sync(默认)，这使得操作在主分片和副</p><p>本分片都完成后才会返回；如果设置 replication 为 async 时，也可以通过设置搜</p><p>索请求参数_preference 为 primary 来查询主分片，确保文档是最新版本。</p><h2 id="如何监控-elasticsearch-集群状态" tabindex="-1"><a class="header-anchor" href="#如何监控-elasticsearch-集群状态"><span>如何监控 Elasticsearch 集群状态？</span></a></h2><p>Marvel 让你可以很简单的通过 Kibana 监控 Elasticsearch。你可以实时查看你</p><p>的集群健康状态和性能，也可以分析过去的集群、索引和节点指标。</p><h2 id="介绍下你们电商搜索的整体技术架构。" tabindex="-1"><a class="header-anchor" href="#介绍下你们电商搜索的整体技术架构。"><span>介绍下你们电商搜索的整体技术架构。</span></a></h2><figure><img src="https://cdn.xiaobaidebug.top/v2-6ea22f379bab8d83f9e4697f19e75191_1440w.webp" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h2 id="介绍一下你们的个性化搜索方案" tabindex="-1"><a class="header-anchor" href="#介绍一下你们的个性化搜索方案"><span>介绍一下你们的个性化搜索方案？</span></a></h2><p>SEE 基于 word2vec 和 Elasticsearch 实现个性化搜索</p><h2 id="是否了解字典树" tabindex="-1"><a class="header-anchor" href="#是否了解字典树"><span>是否了解字典树？</span></a></h2><p>常用字典数据结构如下所示：</p><figure><img src="https://cdn.xiaobaidebug.top/v2-aa1a57bbbcbbf04ef089d6681d662ffe_1440w.webp" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>Trie 的核心思想是空间换时间，利用字符串的公共前缀来降低查询时间的开销以</p><p>达到提高效率的目的。它有 3 个基本性质：</p><p>1、根节点不包含字符，除根节点外每一个节点都只包含一个字符。</p><p>2、从根节点到某一节点，路径上经过的字符连接起来，为该节点对应的字符串。</p><p>3、每个节点的所有子节点包含的字符都不相同。</p><figure><img src="https://cdn.xiaobaidebug.top/v2-df4c8cd2e2b1dad444a50bab3f6d9bb2_1440w.webp" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>1、可以看到，trie 树每一层的节点数是 26^i 级别的。所以为了节省空间，我们</p><p>还可以用动态链表，或者用数组来模拟动态。而空间的花费，不会超过单词数×单</p><p>词长度。</p><p>2、实现：对每个结点开一个字母集大小的数组，每个结点挂一个链表，使用左儿</p><p>子右兄弟表示法记录这棵树；</p><p>3、对于中文的字典树，每个节点的子节点用一个哈希表存储，这样就不用浪费太</p><p>大的空间，而且查询速度上可以保留哈希的复杂度 O(1)。</p><h2 id="拼写纠错是如何实现的" tabindex="-1"><a class="header-anchor" href="#拼写纠错是如何实现的"><span>拼写纠错是如何实现的？</span></a></h2><p>1、拼写纠错是基于编辑距离来实现；编辑距离是一种标准的方法，它用来表示经</p><p>过插入、删除和替换操作从一个字符串转换到另外一个字符串的最小操作步数；</p><p>2、编辑距离的计算过程：比如要计算 batyu 和 beauty 的编辑距离，先创建一个</p><p>7×8 的表（batyu 长度为 5，coffee 长度为 6，各加 2），接着，在如下位置填入</p><p>黑色数字。其他格的计算过程是取以下三个值的最小值：</p><p>如果最上方的字符等于最左方的字符，则为左上方的数字。否则为左上方的数字</p><p>+1。（对于 3,3 来说为 0）</p><p>左方数字+1（对于 3,3 格来说为 2）</p><p>上方数字+1（对于 3,3 格来说为 2）</p><p>最终取右下角的值即为编辑距离的值 3。</p><figure><img src="https://cdn.xiaobaidebug.top/v2-1f5084b94e47d417b3cebd615ef04647_1440w.webp" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>对于拼写纠错，我们考虑构造一个度量空间（Metric Space），该空间内任何关</p><p>系满足以下三条基本条件：</p><p>d(x,y) = 0 -- 假如 x 与 y 的距离为 0，则 x=y</p><p>d(x,y) = d(y,x) -- x 到 y 的距离等同于 y 到 x 的距离</p><p>d(x,y) + d(y,z) &gt;= d(x,z) -- 三角不等式</p><p>1、根据三角不等式，则满足与 query 距离在 n 范围内的另一个字符转 B，其与 A</p><p>的距离最大为 d+n，最小为 d-n。</p><p>2、BK 树的构造就过程如下：每个节点有任意个子节点，每条边有个值表示编辑</p><p>距离。所有子节点到父节点的边上标注 n 表示编辑距离恰好为 n。比如，我们有棵</p><p>树父节点是”book”和两个子节点”cake”和”books”，”book”到”books”</p><p>的边标号 1，”book”到”cake”的边上标号 4。从字典里构造好树后，无论何</p><p>时你想插入新单词时，计算该单词与根节点的编辑距离，并且查找数值为</p><p>d(neweord, root)的边。递归得与各子节点进行比较，直到没有子节点，你就可</p><p>以创建新的子节点并将新单词保存在那。比如，插入”boo”到刚才上述例子的树</p><p>中，我们先检查根节点，查找 d(“book”, “boo”) = 1 的边，然后检查标号为</p><p>1 的边的子节点，得到单词”books”。我们再计算距离 d(“books”, “boo”)=2，</p><p>则将新单词插在”books”之后，边标号为 2。</p><p>3、查询相似词如下：计算单词与根节点的编辑距离 d，然后递归查找每个子节点</p><p>标号为 d-n 到 d+n（包含）的边。假如被检查的节点与搜索单词的距离 d 小于 n，</p><p>则返回该节点并继续查询。比如输入 cape 且最大容忍距离为 1，则先计算和根的</p><p>编辑距离 d(“book”, “cape”)=4，然后接着找和根节点之间编辑距离为 3 到5 的，这</p><p>个就找到了 cake 这个节点，计算 d(“cake”, “cape”)=1，满足条件</p><p>所以返回 <strong>cake</strong>，然后再找和 cake 节点编辑距离是 0 到 2 的，分别找到 cape 和</p><p>cart 节点，这样就得到 <strong>cape</strong> 这个满足条件的结果。</p><figure><img src="https://cdn.xiaobaidebug.top/v2-d5426155b3c3c0a7e49123954f96e347_1440w.webp" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure></div><!--[--><!----><!--]--><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/xiaobaiTech/golang-full-stack/edit/main/src/中间件/es/面试题.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">上次编辑于: </span><!----></div><div class="contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: xiaobaidebug@gmail.com">xiaobai</span><!--]--><!--]--></div></div></footer><!----><div id="comment" class="giscus-wrapper input-top" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!--[--><!----><!--]--><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">默认页脚</div><div class="vp-copyright">Copyright © 2024 小白debug </div></footer></div><!--]--><!--[--><!--[--><!--]--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-D66NMc_a.js" defer></script>
  </body>
</html>
